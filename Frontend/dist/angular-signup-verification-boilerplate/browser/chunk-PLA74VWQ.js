import{b as F,c as O,d as L,f as q}from"./chunk-LRGH7V6E.js";import"./chunk-HPUE7TLN.js";import"./chunk-MLL72OG6.js";import"./chunk-O66SMQNR.js";import{$ as K,A as c,B as U,Ba as ae,C as w,Ca as D,D as f,Ea as R,F as r,G as x,H as S,O as _,P as g,R as P,S as $,T as Q,W as I,X as H,Y as k,Z as J,ga as X,ha as u,ia as A,j as v,ja as Y,ka as Z,l as E,la as ee,ma as te,n as C,na as ie,o as b,p as G,q as z,qa as oe,ra as M,s as l,sa as T,t as p,ta as N,u as m,ua as ne,v as a,wa as re,xa as le,y as o,z as i,za as W}from"./chunk-JYF5EYNH.js";var ve=()=>["/admin/employees"],ge=()=>["add"],Se=(e,d,t)=>({"bg-warning text-dark":e,"bg-success text-light":d,"bg-danger text-light":t}),ye=(e,d,t)=>({"fa-hourglass-half":e,"fa-check-circle":d,"fa-times-circle":t});function _e(e,d){if(e&1&&(o(0,"div",11),r(1),i()),e&2){let t=f();l(),S(" Employee ID: ",t.employeeId," ")}}function he(e,d){e&1&&(o(0,"div",12)(1,"button",13),r(2,"Add Workflow"),i()()),e&2&&(l(),a("routerLink",_(1,ge)))}function Ee(e,d){e&1&&(o(0,"tr")(1,"td",14),r(2,"Loading..."),i()())}function Ce(e,d){if(e&1){let t=U();o(0,"tr")(1,"td"),r(2),i(),o(3,"td"),r(4),i(),o(5,"td")(6,"span",15),c(7,"i",16),r(8),$(9,"titlecase"),i()(),o(10,"td")(11,"select",17),w("ngModelChange",function(n){let h=G(t).$implicit,j=f();return z(j.onStatusChange(h,n))}),o(12,"option",18),r(13,"Pending"),i(),o(14,"option",19),r(15,"Approved"),i(),o(16,"option",20),r(17,"Rejected"),i()()()()}if(e&2){let t=d.$implicit;l(2),x(t.employeeId),l(2),x(t.type),l(2),a("ngClass",P(8,Se,t.status==="pending",t.status==="approved",t.status==="rejected")),l(),a("ngClass",P(12,ye,t.status==="pending",t.status==="approved",t.status==="rejected")),l(),S(" ",Q(9,6,t.status)," "),l(3),a("ngModel",t.status)}}function be(e,d){e&1&&(o(0,"tr")(1,"td",14),r(2,"No workflows found"),i()())}var de=(()=>{class e{workflowService;alertService;route;workflows=[];loading=!1;employeeId=null;selectedStatus="";selectedType="";constructor(t,s,n){this.workflowService=t,this.alertService=s,this.route=n}ngOnInit(){console.log("Initializing workflow list component"),this.route.queryParams.subscribe(t=>{console.log("Query params:",t),this.employeeId=t.employeeId,console.log("Employee ID:",this.employeeId),this.employeeId?this.loadEmployeeWorkflows():this.loadWorkflows()})}loadWorkflows(){console.log("Loading all workflows"),this.loading=!0,this.workflowService.getAll().pipe(v()).subscribe({next:t=>{console.log("Workflows loaded:",t),this.workflows=t,this.loading=!1},error:t=>{console.error("Error loading workflows:",t),this.alertService.error("Error loading workflows: "+t.message),this.loading=!1}})}loadEmployeeWorkflows(){if(!this.employeeId){console.error("Employee ID is missing"),this.alertService.error("Employee ID is required");return}console.log("Loading workflows for employee:",this.employeeId),this.loading=!0,this.workflowService.getByEmployeeId(this.employeeId).pipe(v()).subscribe({next:t=>{console.log("Employee workflows loaded:",t),this.workflows=t,this.loading=!1},error:t=>{console.error("Error loading employee workflows:",t),this.alertService.error("Error loading employee workflows: "+t.message),this.loading=!1}})}filterWorkflows(){this.employeeId?this.loadEmployeeWorkflows():this.loadWorkflows()}updateStatus(t,s){console.log("Updating workflow status:",{id:t,status:s}),this.workflowService.updateStatus(t,s).pipe(v()).subscribe({next:()=>{console.log("Workflow status updated successfully"),this.alertService.success("Workflow status updated successfully"),this.employeeId?this.loadEmployeeWorkflows():this.loadWorkflows()},error:n=>{console.error("Error updating workflow status:",n),this.alertService.error("Error updating workflow status: "+n.message)}})}onStatusChange(t,s){t.status!==s&&this.updateStatus(t.id,s)}static \u0275fac=function(s){return new(s||e)(p(L),p(O),p(W))};static \u0275cmp=C({type:e,selectors:[["ng-component"]],decls:26,vars:8,consts:[[1,"container","mt-4"],[1,"row","mb-4"],[1,"col"],["class","text-muted",4,"ngIf"],["class","col text-end",4,"ngIf"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"text-end","mt-4"],[1,"btn","btn-secondary",3,"routerLink"],[1,"text-muted"],[1,"col","text-end"],[1,"btn","btn-primary",3,"routerLink"],["colspan","6",1,"text-center"],[1,"badge","px-2","py-1","rounded-pill","fw-semibold",3,"ngClass"],[1,"fas","me-1",3,"ngClass"],[1,"form-select",3,"ngModelChange","ngModel"],["value","pending"],["value","approved"],["value","rejected"]],template:function(s,n){s&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),r(4),i(),m(5,_e,2,1,"div",3),i(),m(6,he,3,2,"div",4),i(),o(7,"div",5)(8,"table",6)(9,"thead")(10,"tr")(11,"th"),r(12,"Employee ID"),i(),o(13,"th"),r(14,"Details"),i(),o(15,"th"),r(16,"Status"),i(),o(17,"th"),r(18,"Action"),i()()(),o(19,"tbody"),m(20,Ee,3,0,"tr",7)(21,Ce,18,16,"tr",8)(22,be,3,0,"tr",7),o(23,"div",9)(24,"button",10),r(25,"Back to Employees"),i()()()()()()),s&2&&(l(4),x(n.employeeId?"Employee Workflows":"Workflows"),l(),a("ngIf",n.employeeId),l(),a("ngIf",!n.employeeId),l(14),a("ngIf",n.loading),l(),a("ngForOf",n.workflows),l(),a("ngIf",!n.loading&&n.workflows.length===0),l(2),a("routerLink",_(7,ve)))},dependencies:[I,H,k,T,N,M,A,Z,D,J],styles:[".progress[_ngcontent-%COMP%]{height:20px;margin-bottom:0}.progress-bar[_ngcontent-%COMP%]{line-height:20px;font-size:12px}.badge[_ngcontent-%COMP%]{font-size:12px;padding:5px 10px}.btn-group[_ngcontent-%COMP%]{display:flex;gap:5px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}"]})}return e})();var y=e=>({"is-invalid":e}),we=()=>["../"];function xe(e,d){e&1&&(o(0,"div"),r(1,"Employee ID is required"),i())}function Ie(e,d){if(e&1&&(o(0,"div",31),m(1,xe,2,0,"div",32),i()),e&2){let t=f();l(),a("ngIf",t.f.employeeId.errors.required)}}function ke(e,d){e&1&&(o(0,"div"),r(1,"Type is required"),i())}function Ae(e,d){if(e&1&&(o(0,"div",31),m(1,ke,2,0,"div",32),i()),e&2){let t=f();l(),a("ngIf",t.f.type.errors.required)}}function Me(e,d){e&1&&(o(0,"div"),r(1,"Status is required"),i())}function Te(e,d){if(e&1&&(o(0,"div",31),m(1,Me,2,0,"div",32),i()),e&2){let t=f();l(),a("ngIf",t.f.status.errors.required)}}function Ne(e,d){e&1&&(o(0,"div"),r(1,"Start Date is required"),i())}function We(e,d){if(e&1&&(o(0,"div",31),m(1,Ne,2,0,"div",32),i()),e&2){let t=f();l(),a("ngIf",t.f.startDate.errors.required)}}function De(e,d){e&1&&(o(0,"div"),r(1,"Current Step is required"),i())}function Fe(e,d){e&1&&(o(0,"div"),r(1,"Current Step must be at least 1"),i())}function Oe(e,d){if(e&1&&(o(0,"div",31),m(1,De,2,0,"div",32)(2,Fe,2,0,"div",32),i()),e&2){let t=f();l(),a("ngIf",t.f.currentStep.errors.required),l(),a("ngIf",t.f.currentStep.errors.min)}}function Le(e,d){e&1&&(o(0,"div"),r(1,"Total Steps is required"),i())}function qe(e,d){e&1&&(o(0,"div"),r(1,"Total Steps must be at least 1"),i())}function je(e,d){if(e&1&&(o(0,"div",31),m(1,Le,2,0,"div",32)(2,qe,2,0,"div",32),i()),e&2){let t=f();l(),a("ngIf",t.f.totalSteps.errors.required),l(),a("ngIf",t.f.totalSteps.errors.min)}}function Pe(e,d){e&1&&c(0,"span",33)}var B=(()=>{class e{formBuilder;route;router;workflowService;alertService;form;id;isAddMode;loading=!1;submitted=!1;constructor(t,s,n,h,j){this.formBuilder=t,this.route=s,this.router=n,this.workflowService=h,this.alertService=j}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({employeeId:["",u.required],type:["",u.required],status:["pending",u.required],startDate:["",u.required],endDate:[""],description:[""],currentStep:[1,[u.required,u.min(1)]],totalSteps:[1,[u.required,u.min(1)]],metadata:[{}]}),this.isAddMode||this.workflowService.getById(this.id).pipe(v()).subscribe(t=>{this.form.patchValue(t)})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.createWorkflow():this.updateWorkflow())}createWorkflow(){this.workflowService.create(this.form.value).pipe(v()).subscribe({next:()=>{this.alertService.success("Workflow created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}})}updateWorkflow(){this.workflowService.update(this.id,this.form.value).pipe(v()).subscribe({next:()=>{this.alertService.success("Workflow updated successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}})}static \u0275fac=function(s){return new(s||e)(p(ne),p(W),p(ae),p(L),p(O))};static \u0275cmp=C({type:e,selectors:[["ng-component"]],decls:74,vars:31,consts:[[1,"container","mt-4"],[1,"row"],[1,"col-md-8","offset-md-2"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","employeeId",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","type",1,"form-select",3,"ngClass"],["value",""],["value","onboarding"],["value","offboarding"],["value","transfer"],["value","promotion"],["formControlName","status",1,"form-select",3,"ngClass"],["value","pending"],["value","in_progress"],["value","completed"],["value","rejected"],["type","datetime-local","formControlName","startDate",1,"form-control",3,"ngClass"],["type","datetime-local","formControlName","endDate",1,"form-control"],["formControlName","description","rows","3",1,"form-control"],[1,"col-md-6"],["type","number","formControlName","currentStep",1,"form-control",3,"ngClass"],["type","number","formControlName","totalSteps",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["type","button",1,"btn","btn-link",3,"routerLink"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(s,n){s&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4"),r(6),i()(),o(7,"div",5)(8,"form",6),w("ngSubmit",function(){return n.onSubmit()}),o(9,"div",7)(10,"label",8),r(11,"Employee ID"),i(),c(12,"input",9),m(13,Ie,2,1,"div",10),i(),o(14,"div",7)(15,"label",8),r(16,"Type"),i(),o(17,"select",11)(18,"option",12),r(19,"Select Type"),i(),o(20,"option",13),r(21,"Onboarding"),i(),o(22,"option",14),r(23,"Offboarding"),i(),o(24,"option",15),r(25,"Transfer"),i(),o(26,"option",16),r(27,"Promotion"),i()(),m(28,Ae,2,1,"div",10),i(),o(29,"div",7)(30,"label",8),r(31,"Status"),i(),o(32,"select",17)(33,"option",18),r(34,"Pending"),i(),o(35,"option",19),r(36,"In Progress"),i(),o(37,"option",20),r(38,"Completed"),i(),o(39,"option",21),r(40,"Rejected"),i()(),m(41,Te,2,1,"div",10),i(),o(42,"div",7)(43,"label",8),r(44,"Start Date"),i(),c(45,"input",22),m(46,We,2,1,"div",10),i(),o(47,"div",7)(48,"label",8),r(49,"End Date"),i(),c(50,"input",23),i(),o(51,"div",7)(52,"label",8),r(53,"Description"),i(),c(54,"textarea",24),i(),o(55,"div",1)(56,"div",25)(57,"div",7)(58,"label",8),r(59,"Current Step"),i(),c(60,"input",26),m(61,Oe,3,2,"div",10),i()(),o(62,"div",25)(63,"div",7)(64,"label",8),r(65,"Total Steps"),i(),c(66,"input",27),m(67,je,3,2,"div",10),i()()(),o(68,"div",7)(69,"button",28),m(70,Pe,1,0,"span",29),r(71),i(),o(72,"button",30),r(73,"Cancel"),i()()()()()()()()),s&2&&(l(6),S("",n.isAddMode?"Add":"Edit"," Workflow"),l(2),a("formGroup",n.form),l(4),a("ngClass",g(18,y,n.submitted&&n.f.employeeId.errors)),l(),a("ngIf",n.submitted&&n.f.employeeId.errors),l(4),a("ngClass",g(20,y,n.submitted&&n.f.type.errors)),l(11),a("ngIf",n.submitted&&n.f.type.errors),l(4),a("ngClass",g(22,y,n.submitted&&n.f.status.errors)),l(9),a("ngIf",n.submitted&&n.f.status.errors),l(4),a("ngClass",g(24,y,n.submitted&&n.f.startDate.errors)),l(),a("ngIf",n.submitted&&n.f.startDate.errors),l(14),a("ngClass",g(26,y,n.submitted&&n.f.currentStep.errors)),l(),a("ngIf",n.submitted&&n.f.currentStep.errors),l(5),a("ngClass",g(28,y,n.submitted&&n.f.totalSteps.errors)),l(),a("ngIf",n.submitted&&n.f.totalSteps.errors),l(2),a("disabled",n.loading),l(),a("ngIf",n.loading),l(),S(" ",n.isAddMode?"Create":"Update"," Workflow "),l(),a("routerLink",_(30,we)))},dependencies:[I,k,ee,T,N,X,te,M,A,Y,ie,oe,D],styles:[".form-label[_ngcontent-%COMP%]{font-weight:500}.invalid-feedback[_ngcontent-%COMP%]{display:block}.btn-link[_ngcontent-%COMP%]{text-decoration:none}.card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid rgba(0,0,0,.125)}"]})}return e})();var Re=[{path:"",component:de,canActivate:[q],data:{roles:[F.Admin]}},{path:"add",component:B,canActivate:[q],data:{roles:[F.Admin]}},{path:"edit/:id",component:B,canActivate:[q],data:{roles:[F.Admin]}}],se=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=b({type:e});static \u0275inj=E({imports:[R.forChild(Re),R]})}return e})();var rt=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=b({type:e});static \u0275inj=E({imports:[K,le,re,se]})}return e})();export{rt as WorkflowsModule};
