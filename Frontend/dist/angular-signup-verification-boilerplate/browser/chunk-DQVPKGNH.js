import{a as fe}from"./chunk-MLL72OG6.js";import{a as $}from"./chunk-O66SMQNR.js";import{$ as ie,A as v,B as H,Ba as I,C as f,Ca as ue,D as h,Ea as P,F as o,Fa as C,G as u,Ga as R,H as _,I as z,L as Y,M as J,N as K,O as Q,P as y,Q as X,S as Z,U as ee,W as E,X as S,Y as N,_ as te,a as W,aa as ne,ga as re,ia as j,j as M,ja as oe,k as U,ka as ae,l as w,la as le,m as G,n as b,na as se,o as F,p as T,q as A,qa as me,ra as O,s as l,sa as V,t as c,ta as L,u as p,ua as de,v as s,wa as pe,xa as ce,y as r,z as n,za as q}from"./chunk-JYF5EYNH.js";var ve=(()=>{class i{http;constructor(e){this.http=e}getAll(){return this.http.get(`${C.apiUrl}/employees`)}getById(e){return this.http.get(`${C.apiUrl}/employees/${e}`)}create(e){return this.http.post(`${C.apiUrl}/employees`,e)}update(e,a){return this.http.put(`${C.apiUrl}/employees/${e}`,a)}delete(e){return this.http.delete(`${C.apiUrl}/employees/${e}`)}static \u0275fac=function(a){return new(a||i)(G(ne))};static \u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Se=(i,d)=>({"bg-success text-light":i,"bg-secondary text-light":d});function Ie(i,d){if(i&1){let e=H();r(0,"tr")(1,"td"),o(2),n(),r(3,"td"),o(4),n(),r(5,"td"),o(6),n(),r(7,"td"),o(8),n(),r(9,"td"),o(10),Z(11,"date"),n(),r(12,"td")(13,"span",7),v(14,"i",8),o(15),n()(),r(16,"td")(17,"button",9),f("click",function(){let t=T(e).$implicit,m=h();return A(m.viewRequests(t.id))}),o(18,"Requests"),n(),r(19,"button",9),f("click",function(){let t=T(e).$implicit,m=h();return A(m.viewWorkflows(t.id))}),o(20,"Workflows"),n(),r(21,"button",10),f("click",function(){let t=T(e).$implicit,m=h();return A(m.transfer(t.id))}),o(22,"Transfer"),n(),r(23,"button",11),f("click",function(){let t=T(e).$implicit,m=h();return A(m.edit(t.id))}),o(24,"Edit"),n()()()}if(i&2){let e=d.$implicit;l(2),u(e.employeeId),l(2),u(e.account),l(2),u(e.position),l(2),u(e.department),l(2),u(ee(11,8,e.hireDate,"M/d/yyyy")),l(3),s("ngClass",X(11,Se,e.isActive,!e.isActive)),l(),s("ngClass",e.isActive?"fa-check-circle me-1":"fa-times-circle me-1"),l(),_(" ",e.isActive?"Active":"Inactive"," ")}}var he=(()=>{class i{employeeService;router;employees=[];constructor(e,a){this.employeeService=e,this.router=a}ngOnInit(){this.employeeService.getAll().subscribe(e=>this.employees=e)}add(){this.router.navigate(["/admin/employees/add"])}edit(e){this.router.navigate(["/admin/employees/edit",e])}viewRequests(e){this.router.navigate(["/admin/requests"],{queryParams:{employeeId:e}})}viewWorkflows(e){this.router.navigate(["/admin/workflows"],{queryParams:{employeeId:e}})}transfer(e){this.router.navigate(["/admin/employees/transfer",e])}static \u0275fac=function(a){return new(a||i)(c(ve),c(I))};static \u0275cmp=b({type:i,selectors:[["ng-component"]],decls:26,vars:1,consts:[[1,"card"],[1,"card-header"],[1,"card-body","p-0"],[1,"table","mb-0"],[4,"ngFor","ngForOf"],[1,"card-footer","text-end"],[1,"btn","btn-primary",3,"click"],[1,"badge","px-2","py-1","rounded-pill","fw-semibold",3,"ngClass"],[1,"fas",3,"ngClass"],[1,"btn","btn-info","btn-sm","me-1",3,"click"],[1,"btn","btn-warning","btn-sm","me-1",3,"click"],[1,"btn","btn-primary","btn-sm",3,"click"]],template:function(a,t){a&1&&(r(0,"div",0)(1,"div",1),o(2,"EMPLOYEES"),n(),r(3,"div",2)(4,"table",3)(5,"thead")(6,"tr")(7,"th"),o(8,"Employee ID"),n(),r(9,"th"),o(10,"Account"),n(),r(11,"th"),o(12,"Position"),n(),r(13,"th"),o(14,"Department"),n(),r(15,"th"),o(16,"Hire Date"),n(),r(17,"th"),o(18,"Status"),n(),r(19,"th"),o(20,"Actions"),n()()(),r(21,"tbody"),p(22,Ie,25,14,"tr",4),n()()(),r(23,"div",5)(24,"button",6),f("click",function(){return t.add()}),o(25,"Add Employee"),n()()()),a&2&&(l(22),s("ngForOf",t.employees))},dependencies:[E,S,te],encapsulation:2})}return i})();var x=i=>({"is-invalid":i}),Ae=()=>["/admin/employees"];function ke(i,d){i&1&&(r(0,"div",20),o(1,"Employee ID is required"),n())}function De(i,d){if(i&1&&(r(0,"option",21),o(1),n()),i&2){let e=d.$implicit;s("value",e.email),l(),u(e.email)}}function Me(i,d){i&1&&(r(0,"div",20),o(1,"Account is required"),n())}function we(i,d){i&1&&(r(0,"div",20),o(1,"Position is required"),n())}function Fe(i,d){if(i&1&&(r(0,"option",21),o(1),n()),i&2){let e=d.$implicit;s("value",e.name),l(),u(e.name)}}function Ne(i,d){i&1&&(r(0,"div",20),o(1,"Department is required"),n())}function je(i,d){i&1&&(r(0,"div",20),o(1,"Hire Date is required"),n())}function Oe(i,d){i&1&&(r(0,"div",20),o(1,"Status is required"),n())}var B=(()=>{class i{formBuilder;route;router;employeeService;accountService;departmentService;form;id;isAddMode;loading=!1;submitted=!1;accounts=[];departments=[];constructor(e,a,t,m,g,D){this.formBuilder=e,this.route=a,this.router=t,this.employeeService=m,this.accountService=g,this.departmentService=D}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({employeeId:[{value:"",disabled:!0}],account:[""],position:[""],department:[""],hireDate:[""],status:[""]}),this.accountService.getAll().subscribe(e=>{this.accounts=e.filter(a=>a.isActive)}),this.departmentService.getAll().subscribe(e=>this.departments=e),this.isAddMode?this.employeeService.getAll().subscribe(e=>{let a=0;e.forEach(m=>{let g=m.employeeId&&m.employeeId.match(/EMP(\d+)/);if(g){let D=parseInt(g[1],10);D>a&&(a=D)}});let t="EMP"+String(a+1).padStart(3,"0");this.form.patchValue({employeeId:t})}):this.employeeService.getById(this.id).subscribe(e=>{this.form.patchValue({employeeId:e.employeeId||"",account:e.account||"",position:e.position||"",department:e.department||"",hireDate:e.hireDate?e.hireDate.split("T")[0]:"",status:e.status||""})})}get f(){return this.form.controls}onSubmit(){if(this.submitted=!0,this.form.invalid)return;this.loading=!0;let e=W({},this.form.getRawValue()),a=this.departments.find(m=>m.name===e.department);a&&(e.departmentId=a.id),delete e.department;let t=this.accounts.find(m=>m.email===e.account);t&&(e.accountId=t.id),delete e.account,this.isAddMode?this.createEmployee(e):this.updateEmployee(e)}createEmployee(e){this.employeeService.create(e).subscribe({next:()=>{this.router.navigate(["/admin/employees"],{relativeTo:this.route})},error:a=>{this.loading=!1}})}updateEmployee(e){this.employeeService.update(this.id,e).subscribe({next:()=>{this.router.navigate(["/admin/employees"],{relativeTo:this.route})},error:a=>{this.loading=!1}})}static \u0275fac=function(a){return new(a||i)(c(de),c(q),c(I),c(R),c(fe),c($))};static \u0275cmp=b({type:i,selectors:[["ng-component"]],decls:52,vars:32,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","employeeId",1,"form-control",3,"readonly","ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","account",1,"form-select",3,"ngClass"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","position",1,"form-control",3,"ngClass"],["formControlName","department",1,"form-select",3,"ngClass"],["type","date","formControlName","hireDate",1,"form-control",3,"ngClass"],["formControlName","status",1,"form-select",3,"ngClass"],["value","Active"],["value","Inactive"],[1,"text-end"],[1,"btn","btn-primary","me-2",3,"disabled"],[1,"btn","btn-secondary",3,"routerLink"],[1,"invalid-feedback"],[3,"value"]],template:function(a,t){a&1&&(r(0,"div",0)(1,"div",1),o(2),n(),r(3,"div",2)(4,"form",3),f("ngSubmit",function(){return t.onSubmit()}),r(5,"div",4)(6,"label",5),o(7,"Employee ID"),n(),v(8,"input",6),p(9,ke,2,0,"div",7),n(),r(10,"div",4)(11,"label",5),o(12,"Account"),n(),r(13,"select",8)(14,"option",9),o(15,"Select account"),n(),p(16,De,2,2,"option",10),n(),p(17,Me,2,0,"div",7),n(),r(18,"div",4)(19,"label",5),o(20,"Position"),n(),v(21,"input",11),p(22,we,2,0,"div",7),n(),r(23,"div",4)(24,"label",5),o(25,"Department"),n(),r(26,"select",12)(27,"option",9),o(28,"Select department"),n(),p(29,Fe,2,2,"option",10),n(),p(30,Ne,2,0,"div",7),n(),r(31,"div",4)(32,"label",5),o(33,"Hire Date"),n(),v(34,"input",13),p(35,je,2,0,"div",7),n(),r(36,"div",4)(37,"label",5),o(38,"Status"),n(),r(39,"select",14)(40,"option",9),o(41,"Select status"),n(),r(42,"option",15),o(43,"Active"),n(),r(44,"option",16),o(45,"Inactive"),n()(),p(46,Oe,2,0,"div",7),n(),r(47,"div",17)(48,"button",18),o(49,"Save"),n(),r(50,"button",19),o(51,"Cancel"),n()()()()()),a&2&&(l(2),_("",t.id?"Edit":"Add"," Employee"),l(2),s("formGroup",t.form),l(4),s("readonly",!0)("ngClass",y(19,x,t.submitted&&t.f.employeeId.errors)),l(),s("ngIf",t.submitted&&t.f.employeeId.errors),l(4),s("ngClass",y(21,x,t.submitted&&t.f.account.errors)),l(3),s("ngForOf",t.accounts),l(),s("ngIf",t.submitted&&t.f.account.errors),l(4),s("ngClass",y(23,x,t.submitted&&t.f.position.errors)),l(),s("ngIf",t.submitted&&t.f.position.errors),l(4),s("ngClass",y(25,x,t.submitted&&t.f.department.errors)),l(3),s("ngForOf",t.departments),l(),s("ngIf",t.submitted&&t.f.department.errors),l(4),s("ngClass",y(27,x,t.submitted&&t.f.hireDate.errors)),l(),s("ngIf",t.submitted&&t.f.hireDate.errors),l(4),s("ngClass",y(29,x,t.submitted&&t.f.status.errors)),l(7),s("ngIf",t.submitted&&t.f.status.errors),l(2),s("disabled",t.loading),l(2),s("routerLink",Q(31,Ae)))},dependencies:[E,S,N,le,V,L,re,O,j,oe,se,me,ue],encapsulation:2})}return i})();var Ve=i=>({"is-invalid":i});function Le(i,d){if(i&1&&(r(0,"div",23),o(1),n()),i&2){let e=h();l(),u(e.error)}}function qe(i,d){if(i&1&&(r(0,"div",24),o(1),n()),i&2){let e=h();l(),u(e.success)}}function Re(i,d){if(i&1&&(r(0,"option",25),o(1),n()),i&2){let e=d.$implicit;s("value",e.id),l(),u(e.name)}}function $e(i,d){i&1&&(r(0,"div",26),o(1," Department is required "),n())}function Pe(i,d){i&1&&(r(0,"div",27)(1,"div",28)(2,"span",29),o(3,"Loading..."),n()()())}var be=(()=>{class i{route;router;employeeService;departmentService;employee;departments=[];departmentId;loading=!1;submitted=!1;error;success;constructor(e,a,t,m){this.route=e,this.router=a,this.employeeService=t,this.departmentService=m}ngOnInit(){let e=this.route.snapshot.params.id;if(!e){this.error="Employee ID is required";return}this.loadEmployee(e),this.loadDepartments()}loadEmployee(e){this.loading=!0,this.employeeService.getById(e).pipe(M()).subscribe({next:a=>{this.employee=a;let t=parseInt(a.department);this.departmentId=isNaN(t)?null:t,this.loading=!1},error:a=>{this.error=a.error?.message||"Error loading employee data",this.loading=!1,console.error("Error loading employee:",a)}})}loadDepartments(){this.departmentService.getAll().pipe(M()).subscribe({next:e=>this.departments=e,error:e=>{this.error=e.error?.message||"Error loading departments",console.error("Error loading departments:",e)}})}transfer(){if(this.submitted=!0,this.error=null,this.success=null,!this.departmentId){this.error="Please select a department";return}if(!this.employee||!this.employee.employeeId){this.error="Employee data is not available";return}this.loading=!0,console.log("Initiating transfer:",{employeeId:this.employee.employeeId,departmentId:this.departmentId,currentDepartment:this.employee.department}),this.employeeService.transfer(this.employee.employeeId,this.departmentId).pipe(M()).subscribe({next:e=>{console.log("Transfer response:",e),this.success=e.message||"Employee transferred successfully",this.loading=!1,setTimeout(()=>{this.router.navigate(["/admin/employees"])},1500)},error:e=>{console.error("Transfer error:",e),this.error=e.error?.message||"Error transferring employee",this.loading=!1}})}cancel(){this.router.navigate(["/admin/employees"])}static \u0275fac=function(a){return new(a||i)(c(q),c(I),c(R),c($))};static \u0275cmp=b({type:i,selectors:[["app-transfer"]],decls:35,vars:15,consts:[[1,"modal"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[1,"alert","alert-info","mb-3"],[1,"mb-3"],[1,"form-label"],[1,"form-select",3,"ngModelChange","ngModel","ngClass"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"fas","fa-times"],[1,"btn","btn-primary",3,"click","disabled"],[1,"fas","fa-exchange-alt"],[1,"modal-backdrop"],[1,"alert","alert-danger"],[1,"alert","alert-success"],[3,"value"],[1,"invalid-feedback"],[1,"text-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"]],template:function(a,t){a&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),o(5,"Transfer Employee"),n(),r(6,"button",5),f("click",function(){return t.cancel()}),n()(),r(7,"div",6),p(8,Le,2,1,"div",7)(9,qe,2,1,"div",8),r(10,"div",9)(11,"strong"),o(12,"Employee:"),n(),o(13),v(14,"br"),r(15,"strong"),o(16,"Current Department:"),n(),o(17),n(),r(18,"div",10)(19,"label",11),o(20,"New Department"),n(),r(21,"select",12),K("ngModelChange",function(g){return J(t.departmentId,g)||(t.departmentId=g),g}),r(22,"option",13),o(23,"Select Department"),n(),p(24,Re,2,2,"option",14),n(),p(25,$e,2,0,"div",15),n(),p(26,Pe,4,0,"div",16),n(),r(27,"div",17)(28,"button",18),f("click",function(){return t.cancel()}),v(29,"i",19),o(30," Cancel "),n(),r(31,"button",20),f("click",function(){return t.transfer()}),v(32,"i",21),o(33," Transfer "),n()()()()(),v(34,"div",22)),a&2&&(l(8),s("ngIf",t.error),l(),s("ngIf",t.success),l(4),z(" ",t.employee==null?null:t.employee.employeeId," - ",t.employee==null?null:t.employee.account," "),l(4),_(" ",t.employee==null?null:t.employee.department," "),l(4),Y("ngModel",t.departmentId),s("ngClass",y(13,Ve,t.submitted&&!t.departmentId)),l(),s("ngValue",null),l(2),s("ngForOf",t.departments),l(),s("ngIf",t.submitted&&!t.departmentId),l(),s("ngIf",t.loading),l(2),s("disabled",t.loading),l(3),s("disabled",t.loading))},dependencies:[E,S,N,V,L,O,j,ae],styles:[".modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:1040}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1050;display:flex;align-items:center;justify-content:center}"]})}return i})();var Be=[{path:"",component:he},{path:"add",component:B},{path:"edit/:id",component:B},{path:"transfer/:id",component:be}],_e=(()=>{class i{static \u0275fac=function(a){return new(a||i)};static \u0275mod=F({type:i});static \u0275inj=w({imports:[P.forChild(Be),P]})}return i})();var pt=(()=>{class i{static \u0275fac=function(a){return new(a||i)};static \u0275mod=F({type:i});static \u0275inj=w({imports:[ie,ce,pe,_e]})}return i})();export{pt as EmployeesModule};
