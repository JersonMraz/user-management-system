import{a as g}from"./chunk-O66SMQNR.js";import{$ as R,A as _,B as N,Ba as b,C as p,Ca as K,D as C,Ea as E,F as m,G as h,Ga as Q,H as k,O as F,P as T,W as j,X as L,Y as w,a as I,b as M,ga as V,ha as B,ia as O,ja as G,l as c,la as $,n as u,na as q,o as f,p as S,q as y,qa as P,s as a,t as s,u as v,ua as z,v as l,xa as H,y as o,z as n,za as J}from"./chunk-JYF5EYNH.js";function ee(t,A){if(t&1){let e=N();o(0,"tr")(1,"td"),m(2),n(),o(3,"td"),m(4),n(),o(5,"td"),m(6),n(),o(7,"td")(8,"button",7),p("click",function(){let i=S(e).$implicit,d=C();return y(d.edit(i.id))}),m(9,"Edit"),n(),o(10,"button",8),p("click",function(){let i=S(e).$implicit,d=C();return y(d.delete(i.id))}),m(11,"Delete"),n()()()}if(t&2){let e=A.$implicit;a(2),h(e.name),a(2),h(e.description),a(2),h(e.employeeCount||0)}}var U=(()=>{class t{departmentService;employeeService;router;departments=[];employees=[];constructor(e,r,i){this.departmentService=e,this.employeeService=r,this.router=i}ngOnInit(){this.loadDepartments()}loadDepartments(){this.employeeService.getAll().subscribe(e=>{this.employees=e,this.departmentService.getAll().subscribe(r=>{this.departments=r.map(i=>M(I({},i),{employeeCount:e.filter(d=>d.department===i.name).length}))})})}add(){this.router.navigate(["/admin/departments/add"])}edit(e){this.router.navigate(["/admin/departments/edit",e])}delete(e){confirm("Are you sure you want to delete this department?")&&this.departmentService.delete(e).subscribe(()=>this.loadDepartments())}static \u0275fac=function(r){return new(r||t)(s(g),s(Q),s(b))};static \u0275cmp=u({type:t,selectors:[["ng-component"]],decls:20,vars:1,consts:[[1,"card"],[1,"card-header"],[1,"card-body","p-0"],[1,"table","mb-0"],[4,"ngFor","ngForOf"],[1,"card-footer","text-end"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary","btn-sm","me-1",3,"click"],[1,"btn","btn-danger","btn-sm",3,"click"]],template:function(r,i){r&1&&(o(0,"div",0)(1,"div",1),m(2,"DEPARTMENTS"),n(),o(3,"div",2)(4,"table",3)(5,"thead")(6,"tr")(7,"th"),m(8,"Name"),n(),o(9,"th"),m(10,"Description"),n(),o(11,"th"),m(12,"Employee Count"),n(),o(13,"th"),m(14,"Actions"),n()()(),o(15,"tbody"),v(16,ee,12,3,"tr",4),n()()(),o(17,"div",5)(18,"button",6),p("click",function(){return i.add()}),m(19,"Add Department"),n()()()),r&2&&(a(16),l("ngForOf",i.departments))},dependencies:[L],encapsulation:2})}return t})();var te=t=>({"is-invalid":t}),ie=()=>["/admin/departments"];function ne(t,A){t&1&&(o(0,"div",12),m(1,"Name is required"),n())}var D=(()=>{class t{formBuilder;route;router;departmentService;form;id;isAddMode;loading=!1;submitted=!1;constructor(e,r,i,d){this.formBuilder=e,this.route=r,this.router=i,this.departmentService=d}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({name:["",B.required],description:[""]}),this.isAddMode||this.departmentService.getById(this.id).subscribe(e=>this.form.patchValue(e))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,!this.form.invalid&&(this.loading=!0,this.isAddMode?this.createDepartment():this.updateDepartment())}createDepartment(){this.departmentService.create(this.form.value).subscribe({next:()=>{this.router.navigate(["/admin/departments"],{relativeTo:this.route})},error:e=>{this.loading=!1}})}updateDepartment(){this.departmentService.update(this.id,this.form.value).subscribe({next:()=>{this.router.navigate(["/admin/departments"],{relativeTo:this.route})},error:e=>{this.loading=!1}})}static \u0275fac=function(r){return new(r||t)(s(z),s(J),s(b),s(g))};static \u0275cmp=u({type:t,selectors:[["ng-component"]],decls:19,vars:9,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","text","formControlName","description",1,"form-control"],[1,"text-end"],[1,"btn","btn-primary","me-2",3,"disabled"],[1,"btn","btn-secondary",3,"routerLink"],[1,"invalid-feedback"]],template:function(r,i){r&1&&(o(0,"div",0)(1,"div",1),m(2),n(),o(3,"div",2)(4,"form",3),p("ngSubmit",function(){return i.onSubmit()}),o(5,"div",4)(6,"label",5),m(7,"Name"),n(),_(8,"input",6),v(9,ne,2,0,"div",7),n(),o(10,"div",4)(11,"label",5),m(12,"Description"),n(),_(13,"input",8),n(),o(14,"div",9)(15,"button",10),m(16,"Save"),n(),o(17,"button",11),m(18,"Cancel"),n()()()()()),r&2&&(a(2),k("",i.id?"Edit":"Add"," Department"),a(2),l("formGroup",i.form),a(4),l("ngClass",T(6,te,i.submitted&&i.f.name.errors)),a(),l("ngIf",i.submitted&&i.f.name.errors),a(6),l("disabled",i.loading),a(2),l("routerLink",F(8,ie)))},dependencies:[j,w,$,V,O,G,q,P,K],encapsulation:2})}return t})();var re=[{path:"",component:U},{path:"add",component:D},{path:"edit/:id",component:D}],W=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=f({type:t});static \u0275inj=c({imports:[E.forChild(re),E]})}return t})();var Ce=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=f({type:t});static \u0275inj=c({imports:[R,H,W]})}return t})();export{Ce as DepartmentsModule};
